Done.
Setting up the random seed for reproducibility...
Done.
dynamic_import - class_name:  OracleTrainer
Initializing model...
Done.
Initializing datasets...
Done.
Initializing clients...
dynamic_import - class_name:  OracleClient
Done.
Initializing server...
dynamic_import - class_name:  OracleServer
Running without server optimizer
Running without server optimizer
Done.
Initialize return score, metrics, ckpt, ckpt step...
Setting up metrics...
Done.
Setting up metrics...
Done.
Done.
Initializing optimizer and scheduler...
Done.
dynamic_import - class_name:  OracleClient
The experiment begins...
ROUND 1/15: Training 2 Clients...
CLIENT 1/2: erfurt5 RGB
train RGB
EPOCH 1: ended.
CLIENT 2/2: weimar3 HHA
train HHA
EPOCH 1: ended.
length losses_2:  1  length losses_2:   1
length losses_2:  1
['weimar3HHA']
dict_keys(['weimar3HHA'])
{'Total samples': array(32), 'Overall Acc': 0.10344827586206896, 'Mean Acc': 0.07142857047902496, 'Mean Precision': 0.03508771832358677, 'FreqW Acc': 0.0743745767130532, 'Mean IoU': 0.0509803916752104, 'Class IoU': {0: 0.08823529325259517, 1: 0.0, 2: 0.16666666512345682, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 'X', 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.10714285586734695, 1: 0.0, 2: 0.24999999652777782, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 'X', 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.3333333209876548, 1: 0.0, 2: 0.33333332716049396, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 'X', 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
 length losses_2:   1
['erfurt5RGB']
dict_keys(['erfurt5RGB'])
{'Total samples': array(16), 'Overall Acc': 0.0, 'Mean Acc': 0.0, 'Mean Precision': 0.0, 'FreqW Acc': 0.0, 'Mean IoU': 0.0, 'Class IoU': {0: 0.0, 1: 0.0, 2: 0.0, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.0, 1: 0.0, 2: 0.0, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.0, 1: 0.0, 2: 0.0, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 2/15: Training 2 Clients...
CLIENT 1/2: dusseldorf4 HHA
train HHA
EPOCH 1: ended.
CLIENT 2/2: dusseldorf1 HHA
train HHA
EPOCH 1: ended.
length losses_2:  2  length losses_2:   0
length losses_2:  2
['dusseldorf4HHA', 'dusseldorf1HHA']
dict_keys(['dusseldorf4HHA', 'dusseldorf1HHA'])
{'Total samples': array(96), 'Overall Acc': 0.39215686274509803, 'Mean Acc': 0.1771914769592368, 'Mean Precision': 0.05662181747948527, 'FreqW Acc': 0.25417716164068566, 'Mean IoU': 0.10609398776836221, 'Class IoU': {0: 0.43396226324116927, 1: 'X', 2: 0.1130434779332073, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 'X', 8: 0.19565217320415879, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.6052631561249615, 1: 'X', 2: 0.2954545432162535, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 'X', 8: 0.3396226393734425, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.6052631561249615, 1: 'X', 2: 0.15476190414777022, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 'X', 8: 0.31578947183748846, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
Testing...
Client 1/1 - all_target_train_data_RGB RGB
Traceback (most recent call last):
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 51, in <module>
    run_experiment()
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 20, in run_experiment
    max_score,max_score_2 = trainer.train(*trainer.train_args, **trainer.train_kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 101, in train
    return self.perform_fed_oracle_training(
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 80, in perform_fed_oracle_training
    self.test([self.all_target_client], eval_train_metric, r, 'ROUND', self.get_fake_max_scores(False, 1),
  File "/home/utente/Scrivania/PROVA/LADD/src/general_trainer.py", line 353, in test
    scores = self.perform_test(metric, test_clients, step)
  File "/home/utente/Scrivania/PROVA/LADD/src/general_trainer.py", line 317, in perform_test
    loss = c.test(metric, swa=swa)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 253, in test
    outputs = self.get_test_output(images)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/client.py", line 117, in get_test_output
    return self.model(images)['out']
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 886, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torchvision/models/segmentation/_utils.py", line 25, in forward
    features = self.backbone(x)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/fx/graph_module.py", line 606, in wrapped_call
    return cls_call(self, *args, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/fx/graph_module.py", line 608, in wrapped_call
    return super(type(self), self).__call__(*args, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "<eval_with_key>.12", line 124, in forward
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 446, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 442, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/utente/pycharm/plugins/python-ce/helpers/pydev/pydevd.py", line 2195, in <module>
    main()
  File "/home/utente/pycharm/plugins/python-ce/helpers/pydev/pydevd.py", line 2179, in main
    handle_keyboard_interrupt()
  File "/home/utente/pycharm/plugins/python-ce/helpers/pydev/pydevd.py", line 1997, in handle_keyboard_interrupt
    traceback.print_exception(type(value), value, tb, limit=limit)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/traceback.py", line 103, in print_exception
    for line in TracebackException(
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/traceback.py", line 517, in __init__
    self.stack = StackSummary.extract(
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/traceback.py", line 366, in extract
    f.line
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/traceback.py", line 288, in line
    self._line = linecache.getline(self.filename, self.lineno).strip()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/tokenize.py", line 394, in open
    encoding, lines = detect_encoding(buffer.readline)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/tokenize.py", line 363, in detect_encoding
    first = read_or_stop()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/tokenize.py", line 321, in read_or_stop
    return readline()
KeyboardInterrupt