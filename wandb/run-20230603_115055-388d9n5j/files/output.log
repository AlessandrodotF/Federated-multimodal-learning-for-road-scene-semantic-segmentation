Done.
Setting up the random seed for reproducibility...
Done.
dynamic_import - class_name:  OracleTrainer
Initializing model...
Done.
Initializing datasets...
Done.
Initializing clients...
dynamic_import - class_name:  OracleClient
Done.
Initializing server...
dynamic_import - class_name:  OracleServer
Running without server optimizer
Running without server optimizer
Done.
Initialize return score, metrics, ckpt, ckpt step...
Setting up metrics...
Done.
Setting up metrics...
Done.
Done.
Initializing optimizer and scheduler...
Done.
dynamic_import - class_name:  OracleClient
The experiment begins...
ROUND 1/15: Training 2 Clients...
CLIENT 1/2: erfurt5 RGB
EPOCH 1: ended.
CLIENT 2/2: weimar3 HHA
EPOCH 1: ended.
['weimar3HHA']
{'Total samples': array(32), 'Overall Acc': 0.24175824175824176, 'Mean Acc': 0.09873949475525505, 'Mean Precision': 0.043976607629658514, 'FreqW Acc': 0.16865742830483949, 'Mean IoU': 0.06832298087136557, 'Class IoU': {0: 0.3260869541587902, 1: 0.0, 2: 0.15217391194076876, 3: 0.0, 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.44117646626297585, 1: 0.0, 2: 0.24999999702380957, 3: 0.0, 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.5555555486968451, 1: 0.0, 2: 0.2799999962666667, 3: 0.0, 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
['erfurt5RGB']
{'Total samples': array(24), 'Overall Acc': 0.22727272727272727, 'Mean Acc': 0.11111110943930043, 'Mean Precision': 0.04736841935672523, 'FreqW Acc': 0.14285714141414144, 'Mean IoU': 0.07142857067271353, 'Class IoU': {0: 0.28571428344671207, 1: 0.0, 2: 0.1428571405895692, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.49999999305555565, 1: 0.0, 2: 0.16666666358024698, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.3999999955555556, 1: 0.0, 2: 0.49999997222222375, 3: 'X', 4: 'X', 5: 'X', 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 2/15: Training 2 Clients...
CLIENT 1/2: dusseldorf4 HHA
EPOCH 1: ended.
CLIENT 2/2: dusseldorf1 HHA
EPOCH 1: ended.
['dusseldorf4HHA', 'dusseldorf1HHA']
{'Total samples': array(96), 'Overall Acc': 0.2918287937743191, 'Mean Acc': 0.07229729694693005, 'Mean Precision': 0.0353801168304764, 'FreqW Acc': 0.16751154458162068, 'Mean IoU': 0.04012065376702611, 'Class IoU': {0: 0.33510638238456314, 1: 0.0, 2: 0.0, 3: 'X', 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.14634146281975016, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.5675675658631605, 1: 0.0, 2: 0.0, 3: 'X', 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.2999999975, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.44999999892857145, 1: 0.0, 2: 0.0, 3: 'X', 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.22222222085048013, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 3/15: Training 2 Clients...
CLIENT 1/2: erfurt3 RGB
EPOCH 1: ended.
CLIENT 2/2: tubingen6 RGB
EPOCH 1: ended.
['erfurt3RGB', 'tubingen6RGB']
{'Total samples': array(56), 'Overall Acc': 0.42038216560509556, 'Mean Acc': 0.1525764880019102, 'Mean Precision': 0.05984077798644329, 'FreqW Acc': 0.258472448631482, 'Mean IoU': 0.08996213855541796, 'Class IoU': {0: 0.3962264138483446, 1: 0.0999999988888889, 2: 0.3134328342615282, 3: 0.0, 4: 'X', 5: 0.0, 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 0.0}, 'Class Acc': {0: 0.6666666631393299, 1: 0.24999999305555576, 2: 0.45652173582230626, 3: 0.0, 4: 'X', 5: 0.0, 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 0.0}, 'Class Prec': {0: 0.4941176451211073, 1: 0.1428571405895692, 2: 0.49999999603174605, 3: 0.0, 4: 'X', 5: 0.0, 6: 'X', 7: 'X', 8: 0.0, 9: 'X', 10: 0.0, 11: 'X', 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 0.0}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 4/15: Training 2 Clients...
CLIENT 1/2: tubingen1 HHA
EPOCH 1: ended.
CLIENT 2/2: erfurt4 RGB
Traceback (most recent call last):
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 53, in <module>
    run_experiment()
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 19, in run_experiment
    max_score,max_score_2 = trainer.train(*trainer.train_args, **trainer.train_kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 108, in train
    return self.perform_fed_oracle_training(
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 46, in perform_fed_oracle_training
    losses, losses_2 = self.server.train_clients(partial_metric=partial_train_metric,  partial_metric_2=partial_train_metric_2)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/servers/oracle_server.py", line 67, in train_clients
    out = c.train(partial_metric_2, r=r)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 198, in train
    dict_all_iters_losses = self.run_epoch(epoch, optimizer, metric=partial_metric, r=r)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 168, in run_epoch
    self.__exec_epoch(optimizer, cur_epoch, metric, scheduler, plot_lr, dict_all_iters_losses,
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 91, in __exec_epoch
    for cur_step, samples in enumerate(self.loader):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1175, in _next_data
    self._shutdown_workers()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1301, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/connection.py", line 936, in wait
    ready = selector.select(timeout)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/utente/pycharm/plugins/python-ce/helpers/pydev/pydevd.py", line 2195, in <module>
    main()
  File "/home/utente/pycharm/plugins/python-ce/helpers/pydev/pydevd.py", line 2179, in main
    handle_keyboard_interrupt()
  File "/home/utente/pycharm/plugins/python-ce/helpers/pydev/pydevd.py", line 1997, in handle_keyboard_interrupt
    traceback.print_exception(type(value), value, tb, limit=limit)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/traceback.py", line 103, in print_exception
    for line in TracebackException(
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/traceback.py", line 517, in __init__
    self.stack = StackSummary.extract(
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/traceback.py", line 353, in extract
    linecache.lazycache(filename, f.f_globals)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/linecache.py", line 171, in lazycache
    get_source = getattr(loader, 'get_source', None)
KeyboardInterrupt