Done.
Setting up the random seed for reproducibility...
Done.
dynamic_import - class_name:  OracleTrainer
Initializing model...
Done.
Initializing datasets...
Done.
Initializing clients...
dynamic_import - class_name:  OracleClient
Done.
Initializing server...
dynamic_import - class_name:  OracleServer
Running without server optimizer
Done.
Initialize return score, metrics, ckpt, ckpt step...
Setting up metrics...
Done.
Done.
Initializing optimizer and scheduler...
Done.
dynamic_import - class_name:  OracleClient
The experiment begins...
ROUND 1/1: Training 5 Clients...
CLIENT 1/5: erfurt5 MIX
EPOCH 1: ended.
CLIENT 2/5: weimar3 MIX
EPOCH 1: ended.
CLIENT 3/5: strasbourg3 MIX
strasbourg3 MIX, 20/22: partial_train_loss_tot = 3.828
EPOCH 1: ended.
CLIENT 4/5: tubingen2 MIX
EPOCH 1: ended.
CLIENT 5/5: weimar6 MIX
EPOCH 1: ended.
{'Total samples': array(424), 'Overall Acc': 0.271134797349702, 'Mean Acc': 0.08152499858908159, 'Mean Precision': 0.06437636904220062, 'FreqW Acc': 0.15877303201333925, 'Mean IoU': 0.043766161885162455, 'Class IoU': {0: 0.25702266619416547, 1: 0.018711477451499165, 2: 0.18940359557204417, 3: 0.012325905292049933, 4: 0.0018075581150572206, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.07604647648075312, 9: 0.003176836324782118, 10: 0.0885086740000219, 11: 0.002951252256805805, 12: 0.0, 13: 0.050304148475420404, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Acc': {0: 0.4210112705382209, 1: 0.028135990621129005, 2: 0.3275665287641062, 3: 0.014712605460508184, 4: 0.0040156892041457, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.17631031200552097, 9: 0.0043061023620722776, 10: 0.24752249486524963, 11: 0.005522588469581959, 12: 0.0, 13: 0.07529639513477067, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Prec': {0: 0.39753937178242493, 1: 0.05290594498595683, 2: 0.30989342316820323, 3: 0.07061639735275954, 4: 0.0032764401095978194, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.11795185781219665, 9: 0.011968880908611704, 10: 0.12109043169252805, 11: 0.00629862912174142, 12: 0.0, 13: 0.13160963486779192, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
Testing...
Client 1/1 - test_user MIX
Traceback (most recent call last):
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 53, in <module>
    run_experiment()
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 21, in run_experiment
    max_score = trainer.train(*trainer.train_args, **trainer.train_kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 136, in train
    return self.perform_fed_oracle_training(
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 115, in perform_fed_oracle_training
    max_scores, _ = self.test(self.target_test_clients, test_metric, r, 'ROUND', max_scores,
  File "/home/utente/Scrivania/PROVA/LADD/src/general_trainer.py", line 359, in test
    scores = self.perform_test(metric, test_clients, step)
  File "/home/utente/Scrivania/PROVA/LADD/src/general_trainer.py", line 319, in perform_test
    loss = c.test(metric, swa=swa)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 251, in test
    outputs = self.get_test_output(images)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/client.py", line 159, in get_test_output
    outputs = self.model(x_rgb=x_rgb, z_hha=z_hha)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 878, in forward
    self._sync_params()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1379, in _sync_params
    self._distributed_broadcast_coalesced(
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1334, in _distributed_broadcast_coalesced
    dist._broadcast_coalesced(
KeyboardInterrupt