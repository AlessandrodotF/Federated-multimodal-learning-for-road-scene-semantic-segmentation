Done.
Setting up the random seed for reproducibility...
Done.
dynamic_import - class_name:  OracleTrainer
Initializing model...
Done.
Initializing datasets...
Done.
Initializing clients...
dynamic_import - class_name:  OracleClient
Done.
Initializing server...
dynamic_import - class_name:  OracleServer
Running without server optimizer
Running without server optimizer
Done.
Initialize return score, metrics, ckpt, ckpt step...
Setting up metrics...
Done.
Setting up metrics...
Done.
Done.
Initializing optimizer and scheduler...
Done.
dynamic_import - class_name:  OracleClient
The experiment begins...
ROUND 1/15: Training 2 Clients...
CLIENT 1/2: erfurt5 RGB
EPOCH 1: ended.
CLIENT 2/2: weimar3 HHA
EPOCH 1: ended.
{'Total samples': array(32), 'Overall Acc': 0.24434438618062002, 'Mean Acc': 0.06713005802179556, 'Mean Precision': 0.08377307724896689, 'FreqW Acc': 0.1575547129351574, 'Mean IoU': 0.04375338847536878, 'Class IoU': {0: 0.18753161990790532, 1: 0.18594905035557022, 2: 0.22432998207658375, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.017681545387300344, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.04080862940317207, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Acc': {0: 0.41186494771351256, 1: 0.20134228187871528, 2: 0.31044706224264174, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.0236725711140911, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.05962400737797279, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Prec': {0: 0.2561177748998723, 1: 0.7086416235769045, 2: 0.4471156529656373, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.06530330655826834, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.11451010972968853, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}}
{'Total samples': array(24), 'Overall Acc': 0.39145441161438244, 'Mean Acc': 0.0811286129504488, 'Mean Precision': 0.055173002376793415, 'FreqW Acc': 0.2573016988022673, 'Mean IoU': 0.05164266584649847, 'Class IoU': {0: 0.4148083316242722, 1: 0.0, 2: 0.24390331126975645, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0004823182142603909, 9: 0.0, 10: 0.0, 11: 0.012160694896191059, 12: 0.0, 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 0.0}, 'Class Acc': {0: 0.668897190295793, 1: 0.0, 2: 0.32514466080873955, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0004958890795257725, 9: 0.0, 10: 0.0, 11: 0.06013422817177605, 12: 0.0, 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 0.0}, 'Class Prec': {0: 0.5219877128612883, 1: 0.0, 2: 0.4939659048713542, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.017319016273876338, 9: 0.0, 10: 0.0, 11: 0.015014411152556176, 12: 0.0, 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 0.0}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
primo000000000000000000000 odict_keys(['module.backbone.0.0.weight', 'module.backbone.0.1.weight', 'module.backbone.0.1.bias', 'module.backbone.0.1.running_mean', 'module.backbone.0.1.running_var', 'module.backbone.0.1.num_batches_tracked', 'module.backbone.1.conv.0.weight', 'module.backbone.1.conv.1.weight', 'module.backbone.1.conv.1.bias', 'module.backbone.1.conv.1.running_mean', 'module.backbone.1.conv.1.running_var', 'module.backbone.1.conv.1.num_batches_tracked', 'module.backbone.1.conv.3.weight', 'module.backbone.1.conv.4.weight', 'module.backbone.1.conv.4.bias', 'module.backbone.1.conv.4.running_mean', 'module.backbone.1.conv.4.running_var', 'module.backbone.1.conv.4.num_batches_tracked', 'module.backbone.2.conv.0.weight', 'module.backbone.2.conv.1.weight', 'module.backbone.2.conv.1.bias', 'module.backbone.2.conv.1.running_mean', 'module.backbone.2.conv.1.running_var', 'module.backbone.2.conv.1.num_batches_tracked', 'module.backbone.2.conv.3.weight', 'module.backbone.2.conv.4.weight', 'module.backbone.2.conv.4.bias', 'module.backbone.2.conv.4.running_mean', 'module.backbone.2.conv.4.running_var', 'module.backbone.2.conv.4.num_batches_tracked', 'module.backbone.2.conv.6.weight', 'module.backbone.2.conv.7.weight', 'module.backbone.2.conv.7.bias', 'module.backbone.2.conv.7.running_mean', 'module.backbone.2.conv.7.running_var', 'module.backbone.2.conv.7.num_batches_tracked', 'module.backbone.3.conv.0.weight', 'module.backbone.3.conv.1.weight', 'module.backbone.3.conv.1.bias', 'module.backbone.3.conv.1.running_mean', 'module.backbone.3.conv.1.running_var', 'module.backbone.3.conv.1.num_batches_tracked', 'module.backbone.3.conv.3.weight', 'module.backbone.3.conv.4.weight', 'module.backbone.3.conv.4.bias', 'module.backbone.3.conv.4.running_mean', 'module.backbone.3.conv.4.running_var', 'module.backbone.3.conv.4.num_batches_tracked', 'module.backbone.3.conv.6.weight', 'module.backbone.3.conv.7.weight', 'module.backbone.3.conv.7.bias', 'module.backbone.3.conv.7.running_mean', 'module.backbone.3.conv.7.running_var', 'module.backbone.3.conv.7.num_batches_tracked', 'module.backbone.4.conv.0.weight', 'module.backbone.4.conv.1.weight', 'module.backbone.4.conv.1.bias', 'module.backbone.4.conv.1.running_mean', 'module.backbone.4.conv.1.running_var', 'module.backbone.4.conv.1.num_batches_tracked', 'module.backbone.4.conv.3.weight', 'module.backbone.4.conv.4.weight', 'module.backbone.4.conv.4.bias', 'module.backbone.4.conv.4.running_mean', 'module.backbone.4.conv.4.running_var', 'module.backbone.4.conv.4.num_batches_tracked', 'module.backbone.4.conv.6.weight', 'module.backbone.4.conv.7.weight', 'module.backbone.4.conv.7.bias', 'module.backbone.4.conv.7.running_mean', 'module.backbone.4.conv.7.running_var', 'module.backbone.4.conv.7.num_batches_tracked', 'module.backbone.5.conv.0.weight', 'module.backbone.5.conv.1.weight', 'module.backbone.5.conv.1.bias', 'module.backbone.5.conv.1.running_mean', 'module.backbone.5.conv.1.running_var', 'module.backbone.5.conv.1.num_batches_tracked', 'module.backbone.5.conv.3.weight', 'module.backbone.5.conv.4.weight', 'module.backbone.5.conv.4.bias', 'module.backbone.5.conv.4.running_mean', 'module.backbone.5.conv.4.running_var', 'module.backbone.5.conv.4.num_batches_tracked', 'module.backbone.5.conv.6.weight', 'module.backbone.5.conv.7.weight', 'module.backbone.5.conv.7.bias', 'module.backbone.5.conv.7.running_mean', 'module.backbone.5.conv.7.running_var', 'module.backbone.5.conv.7.num_batches_tracked', 'module.backbone.6.conv.0.weight', 'module.backbone.6.conv.1.weight', 'module.backbone.6.conv.1.bias', 'module.backbone.6.conv.1.running_mean', 'module.backbone.6.conv.1.running_var', 'module.backbone.6.conv.1.num_batches_tracked', 'module.backbone.6.conv.3.weight', 'module.backbone.6.conv.4.weight', 'module.backbone.6.conv.4.bias', 'module.backbone.6.conv.4.running_mean', 'module.backbone.6.conv.4.running_var', 'module.backbone.6.conv.4.num_batches_tracked', 'module.backbone.6.conv.6.weight', 'module.backbone.6.conv.7.weight', 'module.backbone.6.conv.7.bias', 'module.backbone.6.conv.7.running_mean', 'module.backbone.6.conv.7.running_var', 'module.backbone.6.conv.7.num_batches_tracked', 'module.backbone.7.conv.0.weight', 'module.backbone.7.conv.1.weight', 'module.backbone.7.conv.1.bias', 'module.backbone.7.conv.1.running_mean', 'module.backbone.7.conv.1.running_var', 'module.backbone.7.conv.1.num_batches_tracked', 'module.backbone.7.conv.3.weight', 'module.backbone.7.conv.4.weight', 'module.backbone.7.conv.4.bias', 'module.backbone.7.conv.4.running_mean', 'module.backbone.7.conv.4.running_var', 'module.backbone.7.conv.4.num_batches_tracked', 'module.backbone.7.conv.6.weight', 'module.backbone.7.conv.7.weight', 'module.backbone.7.conv.7.bias', 'module.backbone.7.conv.7.running_mean', 'module.backbone.7.conv.7.running_var', 'module.backbone.7.conv.7.num_batches_tracked', 'module.backbone.8.conv.0.weight', 'module.backbone.8.conv.1.weight', 'module.backbone.8.conv.1.bias', 'module.backbone.8.conv.1.running_mean', 'module.backbone.8.conv.1.running_var', 'module.backbone.8.conv.1.num_batches_tracked', 'module.backbone.8.conv.3.weight', 'module.backbone.8.conv.4.weight', 'module.backbone.8.conv.4.bias', 'module.backbone.8.conv.4.running_mean', 'module.backbone.8.conv.4.running_var', 'module.backbone.8.conv.4.num_batches_tracked', 'module.backbone.8.conv.6.weight', 'module.backbone.8.conv.7.weight', 'module.backbone.8.conv.7.bias', 'module.backbone.8.conv.7.running_mean', 'module.backbone.8.conv.7.running_var', 'module.backbone.8.conv.7.num_batches_tracked', 'module.backbone.9.conv.0.weight', 'module.backbone.9.conv.1.weight', 'module.backbone.9.conv.1.bias', 'module.backbone.9.conv.1.running_mean', 'module.backbone.9.conv.1.running_var', 'module.backbone.9.conv.1.num_batches_tracked', 'module.backbone.9.conv.3.weight', 'module.backbone.9.conv.4.weight', 'module.backbone.9.conv.4.bias', 'module.backbone.9.conv.4.running_mean', 'module.backbone.9.conv.4.running_var', 'module.backbone.9.conv.4.num_batches_tracked', 'module.backbone.9.conv.6.weight', 'module.backbone.9.conv.7.weight', 'module.backbone.9.conv.7.bias', 'module.backbone.9.conv.7.running_mean', 'module.backbone.9.conv.7.running_var', 'module.backbone.9.conv.7.num_batches_tracked', 'module.backbone.10.conv.0.weight', 'module.backbone.10.conv.1.weight', 'module.backbone.10.conv.1.bias', 'module.backbone.10.conv.1.running_mean', 'module.backbone.10.conv.1.running_var', 'module.backbone.10.conv.1.num_batches_tracked', 'module.backbone.10.conv.3.weight', 'module.backbone.10.conv.4.weight', 'module.backbone.10.conv.4.bias', 'module.backbone.10.conv.4.running_mean', 'module.backbone.10.conv.4.running_var', 'module.backbone.10.conv.4.num_batches_tracked', 'module.backbone.10.conv.6.weight', 'module.backbone.10.conv.7.weight', 'module.backbone.10.conv.7.bias', 'module.backbone.10.conv.7.running_mean', 'module.backbone.10.conv.7.running_var', 'module.backbone.10.conv.7.num_batches_tracked', 'module.backbone.11.conv.0.weight', 'module.backbone.11.conv.1.weight', 'module.backbone.11.conv.1.bias', 'module.backbone.11.conv.1.running_mean', 'module.backbone.11.conv.1.running_var', 'module.backbone.11.conv.1.num_batches_tracked', 'module.backbone.11.conv.3.weight', 'module.backbone.11.conv.4.weight', 'module.backbone.11.conv.4.bias', 'module.backbone.11.conv.4.running_mean', 'module.backbone.11.conv.4.running_var', 'module.backbone.11.conv.4.num_batches_tracked', 'module.backbone.11.conv.6.weight', 'module.backbone.11.conv.7.weight', 'module.backbone.11.conv.7.bias', 'module.backbone.11.conv.7.running_mean', 'module.backbone.11.conv.7.running_var', 'module.backbone.11.conv.7.num_batches_tracked', 'module.backbone.12.conv.0.weight', 'module.backbone.12.conv.1.weight', 'module.backbone.12.conv.1.bias', 'module.backbone.12.conv.1.running_mean', 'module.backbone.12.conv.1.running_var', 'module.backbone.12.conv.1.num_batches_tracked', 'module.backbone.12.conv.3.weight', 'module.backbone.12.conv.4.weight', 'module.backbone.12.conv.4.bias', 'module.backbone.12.conv.4.running_mean', 'module.backbone.12.conv.4.running_var', 'module.backbone.12.conv.4.num_batches_tracked', 'module.backbone.12.conv.6.weight', 'module.backbone.12.conv.7.weight', 'module.backbone.12.conv.7.bias', 'module.backbone.12.conv.7.running_mean', 'module.backbone.12.conv.7.running_var', 'module.backbone.12.conv.7.num_batches_tracked', 'module.backbone.13.conv.0.weight', 'module.backbone.13.conv.1.weight', 'module.backbone.13.conv.1.bias', 'module.backbone.13.conv.1.running_mean', 'module.backbone.13.conv.1.running_var', 'module.backbone.13.conv.1.num_batches_tracked', 'module.backbone.13.conv.3.weight', 'module.backbone.13.conv.4.weight', 'module.backbone.13.conv.4.bias', 'module.backbone.13.conv.4.running_mean', 'module.backbone.13.conv.4.running_var', 'module.backbone.13.conv.4.num_batches_tracked', 'module.backbone.13.conv.6.weight', 'module.backbone.13.conv.7.weight', 'module.backbone.13.conv.7.bias', 'module.backbone.13.conv.7.running_mean', 'module.backbone.13.conv.7.running_var', 'module.backbone.13.conv.7.num_batches_tracked', 'module.backbone.14.conv.0.weight', 'module.backbone.14.conv.1.weight', 'module.backbone.14.conv.1.bias', 'module.backbone.14.conv.1.running_mean', 'module.backbone.14.conv.1.running_var', 'module.backbone.14.conv.1.num_batches_tracked', 'module.backbone.14.conv.3.weight', 'module.backbone.14.conv.4.weight', 'module.backbone.14.conv.4.bias', 'module.backbone.14.conv.4.running_mean', 'module.backbone.14.conv.4.running_var', 'module.backbone.14.conv.4.num_batches_tracked', 'module.backbone.14.conv.6.weight', 'module.backbone.14.conv.7.weight', 'module.backbone.14.conv.7.bias', 'module.backbone.14.conv.7.running_mean', 'module.backbone.14.conv.7.running_var', 'module.backbone.14.conv.7.num_batches_tracked', 'module.backbone.15.conv.0.weight', 'module.backbone.15.conv.1.weight', 'module.backbone.15.conv.1.bias', 'module.backbone.15.conv.1.running_mean', 'module.backbone.15.conv.1.running_var', 'module.backbone.15.conv.1.num_batches_tracked', 'module.backbone.15.conv.3.weight', 'module.backbone.15.conv.4.weight', 'module.backbone.15.conv.4.bias', 'module.backbone.15.conv.4.running_mean', 'module.backbone.15.conv.4.running_var', 'module.backbone.15.conv.4.num_batches_tracked', 'module.backbone.15.conv.6.weight', 'module.backbone.15.conv.7.weight', 'module.backbone.15.conv.7.bias', 'module.backbone.15.conv.7.running_mean', 'module.backbone.15.conv.7.running_var', 'module.backbone.15.conv.7.num_batches_tracked', 'module.backbone.16.conv.0.weight', 'module.backbone.16.conv.1.weight', 'module.backbone.16.conv.1.bias', 'module.backbone.16.conv.1.running_mean', 'module.backbone.16.conv.1.running_var', 'module.backbone.16.conv.1.num_batches_tracked', 'module.backbone.16.conv.3.weight', 'module.backbone.16.conv.4.weight', 'module.backbone.16.conv.4.bias', 'module.backbone.16.conv.4.running_mean', 'module.backbone.16.conv.4.running_var', 'module.backbone.16.conv.4.num_batches_tracked', 'module.backbone.16.conv.6.weight', 'module.backbone.16.conv.7.weight', 'module.backbone.16.conv.7.bias', 'module.backbone.16.conv.7.running_mean', 'module.backbone.16.conv.7.running_var', 'module.backbone.16.conv.7.num_batches_tracked', 'module.backbone.17.conv.0.weight', 'module.backbone.17.conv.1.weight', 'module.backbone.17.conv.1.bias', 'module.backbone.17.conv.1.running_mean', 'module.backbone.17.conv.1.running_var', 'module.backbone.17.conv.1.num_batches_tracked', 'module.backbone.17.conv.3.weight', 'module.backbone.17.conv.4.weight', 'module.backbone.17.conv.4.bias', 'module.backbone.17.conv.4.running_mean', 'module.backbone.17.conv.4.running_var', 'module.backbone.17.conv.4.num_batches_tracked', 'module.backbone.17.conv.6.weight', 'module.backbone.17.conv.7.weight', 'module.backbone.17.conv.7.bias', 'module.backbone.17.conv.7.running_mean', 'module.backbone.17.conv.7.running_var', 'module.backbone.17.conv.7.num_batches_tracked', 'module.backbone.18.0.weight', 'module.backbone.18.1.weight', 'module.backbone.18.1.bias', 'module.backbone.18.1.running_mean', 'module.backbone.18.1.running_var', 'module.backbone.18.1.num_batches_tracked', 'module.classifier.0.convs.0.0.weight', 'module.classifier.0.convs.0.1.weight', 'module.classifier.0.convs.0.1.bias', 'module.classifier.0.convs.0.1.running_mean', 'module.classifier.0.convs.0.1.running_var', 'module.classifier.0.convs.0.1.num_batches_tracked', 'module.classifier.0.convs.1.0.weight', 'module.classifier.0.convs.1.1.weight', 'module.classifier.0.convs.1.1.bias', 'module.classifier.0.convs.1.1.running_mean', 'module.classifier.0.convs.1.1.running_var', 'module.classifier.0.convs.1.1.num_batches_tracked', 'module.classifier.0.convs.2.0.weight', 'module.classifier.0.convs.2.1.weight', 'module.classifier.0.convs.2.1.bias', 'module.classifier.0.convs.2.1.running_mean', 'module.classifier.0.convs.2.1.running_var', 'module.classifier.0.convs.2.1.num_batches_tracked', 'module.classifier.0.convs.3.0.weight', 'module.classifier.0.convs.3.1.weight', 'module.classifier.0.convs.3.1.bias', 'module.classifier.0.convs.3.1.running_mean', 'module.classifier.0.convs.3.1.running_var', 'module.classifier.0.convs.3.1.num_batches_tracked', 'module.classifier.0.convs.4.1.weight', 'module.classifier.0.convs.4.2.weight', 'module.classifier.0.convs.4.2.bias', 'module.classifier.0.convs.4.2.running_mean', 'module.classifier.0.convs.4.2.running_var', 'module.classifier.0.convs.4.2.num_batches_tracked', 'module.classifier.0.project.0.weight', 'module.classifier.0.project.1.weight', 'module.classifier.0.project.1.bias', 'module.classifier.0.project.1.running_mean', 'module.classifier.0.project.1.running_var', 'module.classifier.0.project.1.num_batches_tracked', 'module.classifier.1.weight', 'module.classifier.2.weight', 'module.classifier.2.bias', 'module.classifier.2.running_mean', 'module.classifier.2.running_var', 'module.classifier.2.num_batches_tracked', 'module.classifier.4.weight', 'module.classifier.4.bias'])
Traceback (most recent call last):
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 53, in <module>
    run_experiment()
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 19, in run_experiment
    max_score,max_score_2 = trainer.train(*trainer.train_args, **trainer.train_kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 127, in train
    return self.perform_fed_oracle_training(
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 53, in perform_fed_oracle_training
    self.server.update_model()
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/servers/oracle_server.py", line 250, in update_model
    averaged_sol_n_rgb = self._aggregation_rgb()
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/servers/oracle_server.py", line 145, in _aggregation_rgb
    print("primo000000000000000000000",self.model.state_dict().keys())
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1310, in state_dict
    module.state_dict(destination, prefix + name + '.', keep_vars=keep_vars)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1310, in state_dict
    module.state_dict(destination, prefix + name + '.', keep_vars=keep_vars)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1310, in state_dict
    module.state_dict(destination, prefix + name + '.', keep_vars=keep_vars)
  [Previous line repeated 2 more times]
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1307, in state_dict
    self._save_to_state_dict(destination, prefix, keep_vars)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1267, in _save_to_state_dict
    destination[prefix + name] = buf if keep_vars else buf.detach()
KeyboardInterrupt
