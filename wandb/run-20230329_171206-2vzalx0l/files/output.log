Done.
Setting up the random seed for reproducibility...
Done.
dynamic_import - class_name:  OracleTrainer
Initializing model...
Done.
Initializing datasets...
Done.
Initializing clients...
dynamic_import - class_name:  OracleClient
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
clients_shared_args
clients_shared_args
clients_shared_args_HHA
clients_shared_args_HHA
Done.
Initializing server...
dynamic_import - class_name:  OracleServer
Running without server optimizer
Running without server optimizer
Done.
Initialize return score, metrics, ckpt, ckpt step...
Setting up metrics...
Done.
Done.
Initializing optimizer and scheduler...
Done.
Generating sample ids for plots...
Done.
dynamic_import - class_name:  OracleClient
The experiment begins...
ROUND 1/2: Training 2 Clients...
CLIENT 1/2: strasbourg7 HHA
EPOCH 1: ended.
CLIENT 2/2: ulm7 HHA
EPOCH 1: ended.
HHA AGGREGATION: END OF THE ROUND
ROUND 2/2: Training 2 Clients...
CLIENT 1/2: stuttgart1 RGB
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7ff5afd85790>
Traceback (most recent call last):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1328, in __del__
    self._shutdown_workers()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1282, in _shutdown_workers
    self._worker_result_queue.put((None, None))
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/queues.py", line 94, in put
    self._start_thread()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/queues.py", line 179, in _start_thread
    self._thread.start()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/threading.py", line 897, in start
    self._started.wait()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/threading.py", line 574, in wait
    signaled = self._cond.wait(timeout)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt:
Traceback (most recent call last):
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 49, in <module>
    run_experiment()
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 20, in run_experiment
    max_score = trainer.train(*trainer.train_args, **trainer.train_kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 64, in train
    return self.perform_fed_oracle_training(
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 37, in perform_fed_oracle_training
    losses = self.server.train_clients(partial_metric=partial_train_metric)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/servers/oracle_server.py", line 60, in train_clients
    out = c.train(partial_metric, r=r)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 197, in train
    dict_all_iters_losses = self.run_epoch(epoch, optimizer, metric=partial_metric, r=r)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 166, in run_epoch
    self.__exec_epoch(optimizer, cur_epoch, metric, scheduler, plot_lr, dict_all_iters_losses,
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 131, in __exec_epoch
    dict_calc_losses, outputs = self.calc_loss_and_output(images, labels)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/client.py", line 93, in calc_loss_and_output
    outputs = self.model(images)['out']
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 878, in forward
    self._sync_params()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1378, in _sync_params
    self._assign_modules_buffers()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 750, in _assign_modules_buffers
    named_module_buffers = [
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 750, in <listcomp>
    named_module_buffers = [
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1594, in named_buffers
    for elem in gen:
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1490, in _named_members
    for module_prefix, module in modules:
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1695, in named_modules
    for m in module.named_modules(memo, submodule_prefix, remove_duplicate):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1695, in named_modules
    for m in module.named_modules(memo, submodule_prefix, remove_duplicate):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1695, in named_modules
    for m in module.named_modules(memo, submodule_prefix, remove_duplicate):
  [Previous line repeated 1 more time]
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1691, in named_modules
    for name, module in self._modules.items():
KeyboardInterrupt
Exception in thread Thread-13:
Traceback (most recent call last):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 289, in rebuild_storage_fd
    fd = df.detach()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/connection.py", line 513, in Client
    answer_challenge(c, authkey)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/connection.py", line 762, in answer_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/connection.py", line 384, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer