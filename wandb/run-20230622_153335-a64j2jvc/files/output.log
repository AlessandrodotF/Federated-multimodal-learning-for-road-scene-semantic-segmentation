Done.
Setting up the random seed for reproducibility...
Done.
dynamic_import - class_name:  OracleTrainer
Initializing model...
Done.
Initializing datasets...
Done.
Initializing clients...
dynamic_import - class_name:  OracleClient
Done.
Initializing server...
dynamic_import - class_name:  OracleServer
Running without server optimizer
Done.
Initialize return score, metrics, ckpt, ckpt step...
Setting up metrics...
Done.
Done.
Initializing optimizer and scheduler...
Done.
dynamic_import - class_name:  OracleClient
The experiment begins...
ROUND 1/5: Training 2 Clients...
CLIENT 1/2: erfurt5 MIX
qui si blocca
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
EPOCH 1: ended.
CLIENT 2/2: weimar3 MIX
qui si blocca
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
bho
EPOCH 1: ended.
{'Total samples': array(112), 'Overall Acc': 0.26332060440405275, 'Mean Acc': 0.09489017611197816, 'Mean Precision': 0.07026286947344018, 'FreqW Acc': 0.14691996142005043, 'Mean IoU': 0.05031441343938141, 'Class IoU': {0: 0.20427087165578378, 1: 0.010525956050356243, 2: 0.2167842687428403, 3: 'X', 4: 0.00018351991190370637, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.04635199507679693, 9: 0.0, 10: 0.18907368312326736, 11: 0.0, 12: 0.0, 13: 0.08752590702977286, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Acc': {0: 0.37981844691030286, 1: 0.011890055589411285, 2: 0.36770217040866493, 3: 'X', 4: 0.0007964319845816451, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.06791543603189934, 9: 0.0, 10: 0.4718177145591992, 11: 0.0, 12: 0.0, 13: 0.1234123861956131, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Prec': {0: 0.30650178500791164, 1: 0.08403819915851618, 2: 0.3456274733155532, 3: 'X', 4: 0.00023841312224688092, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.12739094937813766, 9: 0.0, 10: 0.23983801789118814, 11: 0.0, 12: 0.0, 13: 0.2313596821218097, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 2/5: Training 2 Clients...
CLIENT 1/2: dusseldorf4 MIX
qui si blocca
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f8d4d75bb80>
Traceback (most recent call last):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1328, in __del__
    self._shutdown_workers()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1301, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/multiprocessing/connection.py", line 936, in wait
    ready = selector.select(timeout)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Traceback (most recent call last):
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 53, in <module>
    run_experiment()
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 21, in run_experiment
    max_score = trainer.train(*trainer.train_args, **trainer.train_kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 136, in train
    return self.perform_fed_oracle_training(
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 99, in perform_fed_oracle_training
    losses = self.server.train_clients(partial_metric=partial_train_metric)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/servers/oracle_server.py", line 113, in train_clients
    out = c.train(partial_metric, r=r)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 204, in train
    dict_all_iters_losses = self.run_epoch(epoch, optimizer, metric=partial_metric, r=r)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 174, in run_epoch
    self.__exec_epoch(optimizer, cur_epoch, metric, scheduler, plot_lr, dict_all_iters_losses,
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 135, in __exec_epoch
    dict_calc_losses, outputs = self.calc_loss_and_output(images, labels)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/client.py", line 131, in calc_loss_and_output
    outputs = self.model(x_rgb=x_rgb, z_hha=z_hha)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 886, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/modules/deeplabv3.py", line 31, in forward
    features_hha = self.hha_backbone(z_hha)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/fx/graph_module.py", line 608, in wrapped_call
    return super(type(self), self).__call__(*args, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "<eval_with_key>.9", line 87, in forward
    _10_conv_4 = getattr(getattr(self, "10").conv, "4")(_10_conv_3);  _10_conv_3 = None
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/nn/modules/batchnorm.py", line 148, in forward
    self.num_batches_tracked = self.num_batches_tracked + 1  # type: ignore[has-type]
KeyboardInterrupt
bho
bho
bho
bho