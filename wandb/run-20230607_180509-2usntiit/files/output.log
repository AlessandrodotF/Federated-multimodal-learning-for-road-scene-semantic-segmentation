Done.
Setting up the random seed for reproducibility...
Done.
dynamic_import - class_name:  OracleTrainer
Initializing model...
Done.
Initializing datasets...
Done.
Initializing clients...
dynamic_import - class_name:  OracleClient
Done.
Initializing server...
dynamic_import - class_name:  OracleServer
Running without server optimizer
Running without server optimizer
Done.
Initialize return score, metrics, ckpt, ckpt step...
Setting up metrics...
Done.
Setting up metrics...
Done.
Done.
Initializing optimizer and scheduler...
Done.
dynamic_import - class_name:  OracleClient
The experiment begins...
ROUND 1/6: Training 2 Clients...
CLIENT 1/2: erfurt5 RGB
EPOCH 1: ended.
CLIENT 2/2: weimar3 HHA
EPOCH 1: ended.
{'Total samples': array(32), 'Overall Acc': 0.27767558104130724, 'Mean Acc': 0.08586642907164987, 'Mean Precision': 0.0483626670928512, 'FreqW Acc': 0.17858287594987446, 'Mean IoU': 0.05562533578935536, 'Class IoU': {0: 0.37328488652887026, 1: 0.0008102195694814536, 2: 0.17959886715431195, 3: 0.0, 4: 'X', 5: 0.0, 6: 'X', 7: 0.0, 8: 0.0025593846408898447, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.6151907037708257, 1: 0.0010525207872486221, 2: 0.23856561434123238, 3: 0.0, 4: 'X', 5: 0.0, 6: 'X', 7: 0.0, 8: 0.0038554518171920755, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.48699554895781155, 1: 0.003507131166295636, 2: 0.42083203973104566, 3: 0.0, 4: 'X', 5: 0.0, 6: 'X', 7: 0.0, 8: 0.007555954909019933, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
{'Total samples': array(24), 'Overall Acc': 0.32578524788813434, 'Mean Acc': 0.12357186717646877, 'Mean Precision': 0.06776036299590663, 'FreqW Acc': 0.17432641854708847, 'Mean IoU': 0.05908711505165325, 'Class IoU': {0: 0.39015079680426906, 1: 0.0, 2: 0.05345136709935622, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.019769648293990343, 10: 0.0, 11: 'X', 12: 'X', 13: 0.1274993383189168, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.7971999999900351, 1: 0.0, 2: 0.05735654850587567, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.22244289964686126, 10: 0.0, 11: 'X', 12: 'X', 13: 0.1587192236219158, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.433140225885228, 1: 0.0, 2: 0.4397934722072844, 3: 'X', 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.021237260013718007, 10: 0.0, 11: 'X', 12: 'X', 13: 0.39327593881599554, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 2/6: Training 2 Clients...
CLIENT 1/2: dusseldorf4 HHA
EPOCH 1: ended.
CLIENT 2/2: dusseldorf1 HHA
EPOCH 1: ended.
{'Total samples': array(96), 'Overall Acc': 0.5227080455218407, 'Mean Acc': 0.1199318703486764, 'Mean Precision': 0.07906970733084302, 'FreqW Acc': 0.3785431334559965, 'Mean IoU': 0.07953872593646137, 'Class IoU': {0: 0.6489461929683972, 1: 0.0, 2: 0.2152342144904286, 3: 'X', 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.1725291537989039, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.07683260185272936, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Acc': {0: 0.8254999749306458, 1: 0.0, 2: 0.3688358173901605, 3: 'X', 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.3545755540556951, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.13013483850496865, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}, 'Class Prec': {0: 0.7521213215365478, 1: 0.0, 2: 0.3407308228107529, 3: 'X', 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.2515186399551268, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.15795365498359, 14: 'X', 15: 'X', 16: 'X', 17: 0.0, 18: 0.0}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 3/6: Training 2 Clients...
CLIENT 1/2: erfurt3 RGB
EPOCH 1: ended.
CLIENT 2/2: tubingen6 RGB
EPOCH 1: ended.
{'Total samples': array(56), 'Overall Acc': 0.4842425612446779, 'Mean Acc': 0.10758578853185496, 'Mean Precision': 0.079870546506367, 'FreqW Acc': 0.2905445132982754, 'Mean IoU': 0.062202381644964375, 'Class IoU': {0: 0.49785435312114223, 1: 0.0, 2: 0.36237283894485695, 3: 0.0, 4: 0.0, 5: 0.0013651532004568129, 6: 0.0, 7: 0.0, 8: 0.029901767673178616, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.04154161173483095, 14: 'X', 15: 0.0, 16: 'X', 17: 'X', 18: 0.0}, 'Class Acc': {0: 0.8316188275191904, 1: 0.0, 2: 0.6058132238711743, 3: 0.0, 4: 0.0, 5: 0.0035880398666328184, 6: 0.0, 7: 0.0, 8: 0.031125573765743014, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.14164116295508405, 14: 'X', 15: 0.0, 16: 'X', 17: 'X', 18: 0.0}, 'Class Prec': {0: 0.5536652199793936, 1: 0.0, 2: 0.4741774910575376, 3: 0.0, 4: 0.0, 5: 0.002198697068224862, 6: 0.0, 7: 0.0, 8: 0.4319809068419348, 9: 0.0, 10: 0.0, 11: 0.0, 12: 'X', 13: 0.05551806867388221, 14: 'X', 15: 0.0, 16: 'X', 17: 'X', 18: 0.0}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 4/6: Training 2 Clients...
CLIENT 1/2: tubingen1 HHA
EPOCH 1: ended.
CLIENT 2/2: erfurt4 RGB
EPOCH 1: ended.
{'Total samples': array(32), 'Overall Acc': 0.5283795585365932, 'Mean Acc': 0.16531582302029726, 'Mean Precision': 0.07678987743322961, 'FreqW Acc': 0.3507528464570554, 'Mean IoU': 0.10798359960092112, 'Class IoU': {0: 0.5620959571560081, 1: 0.0, 2: 0.03550433168225288, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 'X', 8: 0.3880749904510939, 9: 'X', 10: 0.0, 11: 'X', 12: 0.0, 13: 0.09416071671985628, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.7894250965445709, 1: 0.0, 2: 0.04648728942147506, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 'X', 8: 0.6486040197681275, 9: 'X', 10: 0.0, 11: 'X', 12: 0.0, 13: 0.16864182446879894, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.6612396336528455, 1: 0.0, 2: 0.1306451612779274, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 'X', 8: 0.4913887055390779, 9: 'X', 10: 0.0, 11: 'X', 12: 0.0, 13: 0.17573417076151188, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
{'Total samples': array(24), 'Overall Acc': 0.4225024337457122, 'Mean Acc': 0.1599908829385922, 'Mean Precision': 0.09127472489450138, 'FreqW Acc': 0.25642753376984445, 'Mean IoU': 0.09900651632038225, 'Class IoU': {0: 0.450328242511458, 1: 0.0, 2: 0.2329792240436891, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.4051189360377311, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0006452769313265719, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.7404272640399132, 1: 0.0, 2: 0.5988419361756362, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.41952628537447656, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0011042267344884224, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.5347505220633908, 1: 0.0, 2: 0.276064758524229, 3: 0.0, 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.9218543718431068, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.001550120564799335, 14: 'X', 15: 'X', 16: 'X', 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 5/6: Training 2 Clients...
CLIENT 1/2: cologne2 HHA
EPOCH 1: ended.
CLIENT 2/2: darmstadt3 HHA
EPOCH 1: ended.
{'Total samples': array(48), 'Overall Acc': 0.46242599754394326, 'Mean Acc': 0.13780008700494953, 'Mean Precision': 0.07618732409104818, 'FreqW Acc': 0.35125140779649316, 'Mean IoU': 0.09569301142523946, 'Class IoU': {0: 0.7938427579751163, 1: 0.0, 2: 0.16938715307548496, 3: 0.0, 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.1715589587085672, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.013527267343704968, 14: 'X', 15: 'X', 16: 0.0, 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.8894268941850558, 1: 0.0, 2: 0.2646705781781243, 3: 0.0, 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.4782090016665386, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.021294570029675643, 14: 'X', 15: 'X', 16: 0.0, 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.880765636574738, 1: 0.0, 2: 0.31996378030995737, 3: 0.0, 4: 'X', 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.21107003044681286, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.03575971039840722, 14: 'X', 15: 'X', 16: 0.0, 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
ROUND 6/6: Training 2 Clients...
CLIENT 1/2: zurich6 RGB
EPOCH 1: ended.
CLIENT 2/2: aachen7 HHA
EPOCH 1: ended.
{'Total samples': array(40), 'Overall Acc': 0.5166591783255376, 'Mean Acc': 0.19035420469841, 'Mean Precision': 0.08135272086055985, 'FreqW Acc': 0.3639094414465719, 'Mean IoU': 0.12397640140681496, 'Class IoU': {0: 0.780927902469648, 1: 0.0, 2: 0.29732790706277806, 3: 'X', 4: 'X', 5: 0.0, 6: 'X', 7: 'X', 8: 0.16150820453572343, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 0.0, 16: 'X', 17: 'X', 18: 0.0}, 'Class Acc': {0: 0.8916160152858259, 1: 0.0, 2: 0.7850433660394198, 3: 'X', 4: 'X', 5: 0.0, 6: 'X', 7: 'X', 8: 0.2268826656588544, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 0.0, 16: 'X', 17: 'X', 18: 0.0}, 'Class Prec': {0: 0.8628359190335732, 1: 0.0, 2: 0.3236795792645155, 3: 'X', 4: 'X', 5: 0.0, 6: 'X', 7: 'X', 8: 0.3591861980525484, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 0.0, 14: 'X', 15: 0.0, 16: 'X', 17: 'X', 18: 0.0}}
{'Total samples': array(24), 'Overall Acc': 0.3622404186333568, 'Mean Acc': 0.11920527153617816, 'Mean Precision': 0.06315395762206721, 'FreqW Acc': 0.21775704150425895, 'Mean IoU': 0.07195857972178374, 'Class IoU': {0: 0.3104038204644722, 1: 0.005793765749205465, 2: 0.07285524419099501, 3: 'X', 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.4024915465349485, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 'X', 14: 'X', 15: 0.0, 16: 0.0, 17: 'X', 18: 'X'}, 'Class Acc': {0: 0.5607079704423872, 1: 0.009980858626948972, 2: 0.0917189046497686, 3: 'X', 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.6488502531788549, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 'X', 14: 'X', 15: 0.0, 16: 0.0, 17: 'X', 18: 'X'}, 'Class Prec': {0: 0.410146994821211, 1: 0.013622579892063327, 2: 0.2615767188479349, 3: 'X', 4: 0.0, 5: 0.0, 6: 'X', 7: 0.0, 8: 0.5145789012580679, 9: 'X', 10: 0.0, 11: 0.0, 12: 'X', 13: 'X', 14: 'X', 15: 0.0, 16: 0.0, 17: 'X', 18: 'X'}}
QUI ARRIVA ALL'UPDATE
AGGREGATION: END OF THE ROUND
Case:   HHA
Testing...
Client 1/1 - test_user HHA
outputs = self.get_test_output(images)
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f02f2a9cb80>
Traceback (most recent call last):
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1328, in __del__
    self._shutdown_workers()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1283, in _shutdown_workers
    self._pin_memory_thread.join()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/threading.py", line 1053, in join
    self._wait_for_tstate_lock()
  File "/home/utente/anaconda3/envs/LADD/lib/python3.9/threading.py", line 1069, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt:
Traceback (most recent call last):
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 53, in <module>
    run_experiment()
  File "/home/utente/Scrivania/PROVA/LADD/src/run.py", line 19, in run_experiment
    max_score,max_score_2 = trainer.train(*trainer.train_args, **trainer.train_kwargs)
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 127, in train
    return self.perform_fed_oracle_training(
  File "/home/utente/Scrivania/PROVA/LADD/src/federated/trainers/oracle_trainer.py", line 69, in perform_fed_oracle_training
    max_scores, _ = self.test(self.target_test_clients, test_metric, r, 'ROUND', max_scores,
  File "/home/utente/Scrivania/PROVA/LADD/src/general_trainer.py", line 353, in test
    scores = self.perform_test(metric, test_clients, step)
  File "/home/utente/Scrivania/PROVA/LADD/src/general_trainer.py", line 319, in perform_test
    loss = c.test(metric, swa=swa)
  File "/home/utente/Scrivania/PROVA/LADD/src/clients/oracle_client.py", line 250, in test
    self.update_metric(metric, outputs, labels, is_test=True)
KeyboardInterrupt